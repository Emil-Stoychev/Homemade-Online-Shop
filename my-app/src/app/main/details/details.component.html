<div class="container">

  <div class="card" *ngIf="product.title">
    <div class="image">
      <img src={{product?.images[imageCount]?.dataString}} alt="">
      <div class="sliders">
        <button (click)="previousImage()">
          <</button> <button (click)="nextImage()">>
        </button>
      </div>
    </div>

    <div class="details">
      <h2>{{product?.title}}</h2>

      <p>Desc: {{product?.description}}</p>

      <p>Category: {{product?.category}}</p>

      <p>Price: <span>â‚¬ {{product?.price}}</span></p>

      <p>Likes: {{product?.likes?.length}}</p>

      <div class="btns" *ngIf="this.appComponent.sessionStorage">
        <button *ngIf="isAuthor" (click)="onEditHandler(product?._id)">Edit</button>
        <button *ngIf="isAuthor" (click)="deleteBtn = !deleteBtn">Delete</button>
        <button *ngIf="!isAuthor" (click)="buyBtn = !buyBtn">Buy</button>
        <button *ngIf="!isAuthor && !isLiked" (click)="onLikeHandler(product?._id)">Like</button>
        <button *ngIf="!isAuthor && isLiked" (click)="onUnLikeHandler(product?._id)">Unlike</button>
        <button *ngIf="isAuthor && isVisible" (click)="changeStatusHandler(product?._id)">Visible: ON</button>
        <button *ngIf="isAuthor && !isVisible" (click)="changeStatusHandler(product?._id)">Visible: OFF</button>
      </div>

      <div class='deleteQA' *ngIf="deleteBtn || buyBtn">
        <h3 *ngIf="deleteBtn">Are you sure you want to delete this item?</h3>
        <h3 *ngIf="buyBtn">Are you sure you want to buy this item?</h3>

        <button class="dangerBtn" *ngIf="deleteBtn" (click)="onDeleteHandler()">Yes</button>
        <button *ngIf="deleteBtn" (click)="deleteBtn = false">No</button>

        <h4 class="errorsMessage" *ngIf="errors.message">{{errors?.message}}</h4>
        <button *ngIf="buyBtn" (click)="onBuyHandler()">Yes</button>
        <button *ngIf="buyBtn" (click)="buyBtn = false">No</button>

      </div>
    </div>
  </div>

  <div class="comments-section">
    <h2>Comments</h2>
    
    <div class="type">
      <textarea name="comment" cols="30" rows="10"></textarea>

      <div class="btn">
        <button>Comment</button>
      </div>
    </div>

    <div class="all-comments">

      <div class="comments" *ngFor="let comments of product?.comments">

        <div class="main">

          <div class="info">
            <img src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png" alt="">

            <div class="sub-info">
              <h3>{{comments?.email}}</h3>
              <p>{{comments?.date}}</p>
            </div>
          </div>

          <p>{{comments?.title}}</p>

          <hr>
          <div class="btns">
            <button>Like</button>
            <p>{{comments?.likes.length}} likes</p>
            <button>Reply</button>
            <button>Edit</button>
          </div>
        </div>

        <div class="nested-comments main" *ngFor="let nestedComment of comments?.nestedComments">
          <div class="info">
            <img src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png" alt="">

            <div class="sub-info">
              <h3>{{nestedComment?.email}}</h3>
              <p>{{nestedComment?.date}}</p>
            </div>
          </div>

          <p>{{nestedComment?.title}}</p>

          <hr>
          <div class="btns">
            <button>Like</button>
            <p>{{nestedComment?.likes.length}} likes</p>
          </div>
        </div>

      </div>

    </div>


  </div>

</div>
